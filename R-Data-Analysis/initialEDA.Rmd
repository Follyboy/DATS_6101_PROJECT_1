---
title: "initialEDA"
output: html_document
date: "2022-10-19"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
data <- data.frame(read.csv("dataset.csv"))

# Extracting the variables we need from the data set
brainData <- select(data, -c('id'))
brainData[brainData == ''] <- NA
head(brainData)
str(brainData)
```

Converting categorical variables as factor
```{r}
#gender,hypertension,heart_disease,ever_married,work_type,Residence_type,smoking_status,stroke
brainData$gender = factor(brainData$gender)
brainData$hypertension = factor(brainData$hypertension)
brainData$heart_disease = factor(brainData$heart_disease)
brainData$ever_married = factor(brainData$ever_married)
brainData$work_type = factor(brainData$work_type)
brainData$Residence_type = factor(brainData$Residence_type)
brainData$smoking_status = factor(brainData$smoking_status)
brainData$stroke = factor(brainData$stroke)
str(brainData)
```

```{r results='markup'}
corr_brain <- select_if(brainData, is.numeric)
head(corr_brain)
library("corrplot")
cor_mat <- cor(corr_brain)
#corrplot(cor_mat,method="number")
#pairs(brainData)
```

```{r results='markup'}
library(ggplot2)
ggplot(brainData, aes(y=avg_glucose_level, x=stroke)) + 
  geom_boxplot() + 
  geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=4, outlier.size=2) +
  labs(title="outlier in avg glucose level  not due to stroke`", x="", y = "avg glucose level")

ggplot(brainData, aes(y=bmi, x=stroke)) + 
  geom_boxplot() + 
  geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=4, outlier.size=2) +
  labs(title="outlier in bmi  not due to stroke`", x="", y = "bmi")
```
**avg glucose level of people with stroke is higher than the max of people without stroke**

```{r results='markup'}
ggplot(data=brainData, aes(bmi)) + 
  geom_histogram(breaks=seq(66, 86, by = 1), 
                 col="red", 
                 fill="blue", 
                 alpha = .7) + # opacity
  labs(x="bmi", y="Frequency") +
  labs(title="bmi histogram using `ggplot`") 


ggplot(data=brainData, aes(age)) + 
  geom_histogram(breaks=seq(66, 86, by = 1), 
                 col="red", 
                 fill="blue", 
                 alpha = .7) + # opacity
  labs(x="age", y="Frequency") +
  labs(title="bmi age using `ggplot`") 



```


```{r results='markup'}
#bmi
ggplot(data = brainData, mapping = aes(x = work_type, y = bmi)) +
  geom_boxplot()


ggplot(data = brainData, mapping = aes(x = Residence_type, y = bmi)) +
  geom_boxplot()

ggplot(data = brainData, mapping = aes(x = ever_married, y = bmi)) +
  geom_boxplot()

ggplot(data = brainData, mapping = aes(x = smoking_status, y = bmi)) +
  geom_boxplot()

ggplot(data = brainData, mapping = aes(x = hypertension, y = bmi)) +
  geom_boxplot()


```

```{r results='markup'}
#avg_glucose_level
ggplot(data = brainData, mapping = aes(x = work_type, y = avg_glucose_level)) +
  geom_boxplot()


ggplot(data = brainData, mapping = aes(x = Residence_type, y = avg_glucose_level)) +
  geom_boxplot()

ggplot(data = brainData, mapping = aes(x = ever_married, y = avg_glucose_level)) +
  geom_boxplot()

ggplot(data = brainData, mapping = aes(x = smoking_status, y = avg_glucose_level)) +
  geom_boxplot()
#hypertension high => high avg bloood sugar
ggplot(data = brainData, mapping = aes(x = hypertension, y = avg_glucose_level)) +
  geom_boxplot()


```

```{r, results='markup'}
qqnorm(brainData$age, main="Q-Q plot of age", col="blue", ylab="age quantiles")
qqline(brainData$age)
qqnorm(brainData$bmi, main="Q-Q plot of bmi", col="blue", ylab="bmi quantiles")
qqline(brainData$bmi)
qqnorm(brainData$avg_glucose_level, main="Q-Q plot of avg_glucose_level", col="blue", ylab="avg_glucose_level quantiles")
qqline(brainData$avg_glucose_level)
```
```{r, results='markup'}
summary(brainData)
```
Number of NA values in bmi: 1462\
Number of NA values in smoking_status: 13292\
```{r, results='markup'}
library(ggplot2)
ggplot(data=brainData, aes(bmi)) +
geom_histogram(col="black",
fill="blue") +
labs(x="bmi", y="frequency") +
labs(title="plot of bmi")
```
```{r, results='markup'}
tempdf <- subset(brainData, !is.na(bmi))  # removing NA values from bmi and storing it in tempdf
density_bmi <- density(tempdf$bmi)
plot(density_bmi)

ggplot(data = tempdf, mapping = aes(y = bmi)) +
  geom_boxplot() + geom_boxplot( colour="black", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=2)

```
From the boxplot, we can see that there are multiple outliers.
```{r, results='markup'}
#install.packages("moments")
library(moments)

skewness(tempdf$bmi)
```
From the density curve and skewness value, BMI is rightly skewed. So mean is not the right central tendency to fill NA values in BMI.
We will NA values in BMI using median of the data.
Note: Negative skewness value indicates left skewed and positive skewness value indicates right skewed.
The rule of thumb seems to be:

If the skewness is between -0.5 and 0.5, the data are fairly symmetrical
If the skewness is between -1 and â€“ 0.5 or between 0.5 and 1, the data are moderately skewed
If the skewness is less than -1 or greater than 1, the data are highly skewed



```{r, results='markup'}
brainData$bmi[is.na(brainData$bmi)] <- median(brainData$bmi, na.rm = T) #replacing NA values with median of the remaining bmi values.
summary(brainData)
```


**Data Analysis for Smoking Status**
```{r results='markup'}
no_na_for_smoking_status <- subset(brainData, !is.na(smoking_status))
no_na_for_smoking_status
select_smoke <- select(no_na_for_smoking_status, c('smoking_status','stroke'))
smoke_effect <- select_smoke %>% group_by(smoking_status, stroke) %>% count(stroke)
ggplot(smoke_effect, aes(smoking_status, n, fill = stroke)) + 
  geom_bar(stat = 'identity', position=position_dodge()) + 
  ggtitle("Distribution for smoking_status on stroke")
```


After the analysis of smoking status against stroke where `0` is `No` and `1` is `Yes`, we notice that smoking status does indeed have an effect on stroke. According to the graph, we see that 